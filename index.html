<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Playground</title>

  <!-- Codicons (UI icons) -->
  <link rel="stylesheet" href="https://microsoft.github.io/vscode-codicons/dist/codicon.css">

  <!-- Monaco Editor -->
  <script>
    window.require = {
      paths: {
        vs: "https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs"
      }
    };
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>

  <!-- VSCode Icons (SVG CDN mirror) -->
  <script>
    const ICON_CDN = "https://raw.githubusercontent.com/elmhamed/vscode-icons/master/icons/";
  </script>

  <style>
    body {
      margin: 0;
      height: 100vh;
      display: flex;
      overflow: hidden;
      background: #1e1e1e;
      color: #fff;
      font-family: sans-serif;
    }

    /* Left panel (file explorer + editor) */
    #left {
      width: 50%;
      display: flex;
      flex-direction: row;
      border-right: 1px solid #333;
    }

    /* File explorer */
    #explorer {
      width: 200px;
      padding: 10px;
      background: #252526;
      overflow-y: auto;
      border-right: 1px solid #333;
    }

    #explorer-title {
      font-size: 13px;
      opacity: 0.8;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    #editor {
      flex: 1;
      height: 100%;
    }

    /* File entry */
    .item {
      display: flex;
      align-items: center;
      padding: 4px;
      gap: 6px;
      cursor: pointer;
      border-radius: 4px;
      user-select: none;
    }

    .item:hover {
      background: #3a3d41;
    }

    .icon {
      width: 18px;
      height: 18px;
      background-size: contain;
      background-repeat: no-repeat;
      flex-shrink: 0;
    }

    /* Preview iframe */
    #preview {
      width: 50%;
      height: 100%;
      border: none;
      background: white;
    }

    /* Run button */
    #run-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 50;
      padding: 6px 14px;
      font-size: 13px;
      background: #0e639c;
      border: none;
      color: white;
      border-radius: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    #run-btn:hover {
      background: #1177bb;
    }

  </style>
</head>

<body>

<button id="run-btn">
  <span class="codicon codicon-play"></span> Run
</button>

<div id="left">

  <div id="explorer">
    <div id="explorer-title">
      <span>EXPLORER</span>
      <span class="codicon codicon-add"></span>
    </div>
    <div id="tree"></div>
  </div>

  <div id="editor"></div>
</div>

<iframe id="preview" sandbox="allow-scripts"></iframe>

<script>
/* ---------------------------------------------------------
   File structure (you can expand later)
--------------------------------------------------------- */
const files = {
  "index.html": {
    language: "html",
    icon: "file_type_html.svg",
    content: "<h1>Hello World!</h1>"
  },
  "style.css": {
    language: "css",
    icon: "file_type_css.svg",
    content: "body { background: #fafafa; } h1 { color: #09f; }"
  },
  "script.js": {
    language: "javascript",
    icon: "file_type_js.svg",
    content: "console.log('Hello from JS');"
  }
};

let currentFile = "index.html";
let editor;

/* ---------------------------------------------------------
   Render file explorer
--------------------------------------------------------- */
function renderTree() {
  const tree = document.getElementById("tree");
  tree.innerHTML = "";

  Object.keys(files).forEach((file) => {
    const item = document.createElement("div");
    item.className = "item";

    const icon = document.createElement("div");
    icon.className = "icon";
    icon.style.backgroundImage = `url('${ICON_CDN}${files[file].icon}')`;

    const name = document.createElement("span");
    name.textContent = file;

    item.appendChild(icon);
    item.appendChild(name);

    item.onclick = () => loadFile(file);

    tree.appendChild(item);
  });
}

/* ---------------------------------------------------------
   Load file into Monaco
--------------------------------------------------------- */
function loadFile(name) {
  currentFile = name;
  editor.setValue(files[name].content);
  monaco.editor.setModelLanguage(editor.getModel(), files[name].language);
}

/* ---------------------------------------------------------
   Save editor changes
--------------------------------------------------------- */
function saveFile() {
  files[currentFile].content = editor.getValue();
}

/* ---------------------------------------------------------
   Monaco setup
--------------------------------------------------------- */
require(["vs/editor/editor.main"], () => {
  editor = monaco.editor.create(document.getElementById("editor"), {
    value: files["index.html"].content,
    language: "html",
    theme: "vs-dark",
    automaticLayout: true
  });

  renderTree();
});

/* ---------------------------------------------------------
   Run preview (HTML sandbox)
--------------------------------------------------------- */
document.getElementById("run-btn").onclick = () => {
  saveFile();

  const html = files["index.html"].content;
  const css = `<style>${files["style.css"].content}</style>`;
  const js = `<script>${files["script.js"].content}<\/script>`;

  const doc = `
    <!DOCTYPE html>
    <html>
      <head>${css}</head>
      <body>${html}${js}</body>
    </html>
  `;

  document.getElementById("preview").srcdoc = doc;
};
</script>

</body>
</html>
